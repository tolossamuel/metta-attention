!(register-module! ../../../metta-attention)
!(import! &self metta-attention:attention-bank:utilities:helper-functions)
!(import! &self metta-attention:attention-bank:attention-value:getter-and-setter)
!(import! &self metta-attention:attention-bank:bank:atombins)
!(import! &self metta-attention:attention-bank:bank:attention-bank)
!(import! &self metta-attention:attention-bank:bank:attentional-focus)

; Test attentional focus
!(add-atom &atombin (1 (a)))
!(add-atom &atombin (2 (d)))
!(add-atom &atombin (17 (s c)))
!(add-atom &atombin (18 (g)))
!(add-atom &atombin (37 (f h j k)))
!(setAv a (0 0 0))
!(setAv d (7 4 0))
!(setAv c (0 0 0))
!(setAv A (100 200 300))
!(setAv B (50 150 250))
!(setAv C (200 300 400))
!(setAv D (25 125 225))
!(setAv F (70 100 200))
!(addAtomToAF a)
!(addAtomToAF A)
!(addAtomToAF B)
!(addAtomToAF C)
!(addAtomToAF D)
!(addAtomToAF F)
!(assertEqual(attentionalFocusSize) 6)
!(assertEqual(atomIsInAF C) True)
!(assertEqual (sortAtomsBySti  (getAtomList)) (a D B F A C))
!(assertEqual (getLowestStiAtomInAF) a)
!(setAv G (300 400 500))
!(updateAttentionalFocus G) 
!(assertEqual (getAtomList) (a A B C D F G))
!(setAv H (15 25 35))
!(updateAttentionalFocus H) 
!(assertEqual (getAtomList) (a A B C D F G H))
!(setAv I (500 600 700))
!(updateAttentionalFocus I) 
!(setAv A (600 200 300))
!(updateAttentionalFocus A)
!(assertEqual (updateAttentionalFocus L) (Atom is not valid))
!(assertEqual (getAtomList) (a A B C D F G H I))
!(assertEqual (sortAtomsBySti  (getAtomList)) (a H D B F C G I A))
!(let $res (collapse (getRandomAtomNotInAF)) (assertEqual (size $res) 1))
